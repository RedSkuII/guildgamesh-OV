====================================================================
DISCORD BOT CONFIGURATION GUIDE
Resource Tracker - Complete Bot Dashboard Documentation
====================================================================

OVERVIEW
--------
The Bot Dashboard provides a complete interface for configuring Discord 
bot integration. This guide covers server selection, channel/role 
configuration, points system, and bot implementation.

QUICK TIP
---------
Hold Ctrl (Windows/Linux) or Cmd (Mac) to select multiple channels 
or roles in the dropdowns below.

====================================================================
SERVER SELECTION & SORTING
====================================================================

Discord Server Dropdown:
- Select which Discord server to configure
- Automatically sorted: Servers with bot installed first (‚úÖ), then 
  servers without bot (‚ö†Ô∏è)
- Owner servers marked with üëë crown icon
- Shows real-time bot presence status
- Only displays servers where you have Administrator permissions or 
  ownership

In-Game Guild Dropdown:
- Select which in-game guild (House, Clan) to manage
- Your Discord server can have MULTIPLE in-game guilds
- Each in-game guild can only belong to ONE Discord server
- Guilds on your server are completely separate (independent tracking)
- Switch between guilds to view/edit their resources separately

Adding Bot to Server:
1. Select your Discord server from dropdown
2. If bot not present, click "Add Bot to Server" button
3. Authorize with Administrator permissions
4. Refresh page to see configuration panel

====================================================================
CHANNEL CONFIGURATION (MULTI-SELECT)
====================================================================

Bot Channels - Where the bot posts notifications:
‚Ä¢ Select multiple channels (hold Ctrl/Cmd)
‚Ä¢ Examples: #announcements, #bot-logs, #resource-tracker
‚Ä¢ Used for: Website change notifications, general bot messages
‚Ä¢ Visual tags show selected channels with quick removal (√ó)

Order Channels - Where resource orders are created:
‚Ä¢ Select multiple channels for order management
‚Ä¢ Examples: #orders, #requests, #marketplace
‚Ä¢ Used for: Public order system, fulfillment tracking
‚Ä¢ Supports Discord slash commands for creating/filling orders

====================================================================
ROLE CONFIGURATION (MULTI-SELECT)
====================================================================

Admin Roles - Roles that can access the bot dashboard:
‚Ä¢ Select multiple roles (hold Ctrl/Cmd)
‚Ä¢ Examples: @Admin, @Moderator, @Officers
‚Ä¢ Grants access to: Configuration changes, statistics, activity logs
‚Ä¢ Separate from resource permissions (controlled via DISCORD_ROLES_CONFIG 
  environment variable)

====================================================================
POINTS & BONUS SYSTEM
====================================================================

Discord Order Fulfillment Bonus: 0-200%
----------------------------------------
‚Ä¢ Default: 50% (1.5x points)
‚Ä¢ Controls point multiplier for filling orders via Discord bot
‚Ä¢ Scaling:
  - 0% = No bonus (1.0x base points)
  - 50% = 1.5x points (recommended)
  - 100% = 2.0x points (double points)
  - 200% = 3.0x points (triple points)
‚Ä¢ Purpose: Encourages Discord-based resource distribution

Website Resource Addition Bonus: 0-200%
----------------------------------------
‚Ä¢ Default: 0% (no bonus)
‚Ä¢ Controls point multiplier for adding resources via website
‚Ä¢ Same scaling as Discord bonus
‚Ä¢ Use cases:
  - Set higher to encourage website usage
  - Set lower to prioritize Discord activity
  - Match Discord bonus for equal rewards

Point Calculation Examples:
---------------------------
‚Ä¢ Base points for adding 1000 resources = 100 points (0.1 per resource)
‚Ä¢ With 100% website bonus = 200 points
‚Ä¢ With 200% website bonus = 300 points
‚Ä¢ Filling Discord order with 50% bonus = 150 points per 1000 resources

Note: Bonuses only apply to ADD actions, not SET or REMOVE operations.
Status bonuses (critical +10%, below target +5%) also apply separately.

====================================================================
BOT BEHAVIOR TOGGLES
====================================================================

‚úÖ Auto-Update Discord Embeds
-----------------------------
‚Ä¢ Enabled: Bot edits existing embed messages when data changes
‚Ä¢ Disabled: Creates new messages for each update (historical record)
‚Ä¢ Use case: Keep pinned stock messages synchronized in real-time
‚Ä¢ Prevents: Channel spam from repeated new messages
‚Ä¢ Recommendation: Enable for most servers

‚úÖ Notify on Website Resource Changes
--------------------------------------
‚Ä¢ Enabled: Bot posts notifications when resources are added/removed 
  via website
‚Ä¢ Disabled: Only Discord-based changes trigger notifications
‚Ä¢ Use case: Keep Discord community informed of website activity
‚Ä¢ Example notification: "üîî @Username added 1000x Iron Ore (+10 points)"
‚Ä¢ Recommendation: Enable for active guilds with website users

‚úÖ Allow Public Orders
----------------------
‚Ä¢ Enabled: Any guild member can create resource requests via Discord
‚Ä¢ Disabled: Only admins/designated roles can manage orders
‚Ä¢ Use case: Democratic resource distribution vs. centralized control
‚Ä¢ Example command: /order create Metal Alloy 500
‚Ä¢ Recommendation: Enable for community-driven guilds, disable for 
  admin-controlled distribution

====================================================================
CONFIGURATION WORKFLOW FOR SERVER OWNERS
====================================================================

Step 1: Add Bot to Discord Server
----------------------------------
‚Ä¢ Select your server from dropdown
‚Ä¢ If bot not present, click "Add Bot to Server" button
‚Ä¢ Authorize with Administrator permissions
‚Ä¢ Refresh page to see configuration panel

Step 2: Select In-Game Guild
-----------------------------
‚Ä¢ Choose which in-game guild (House, Clan) to track
‚Ä¢ This links your Discord server to resource tracking
‚Ä¢ Your Discord server can track multiple in-game guilds (each configured separately)

Step 3: Configure Channels
---------------------------
‚Ä¢ Select Bot Channels (where bot posts notifications)
  - Hold Ctrl/Cmd to select multiple
  - Examples: #announcements, #bot-logs
‚Ä¢ Select Order Channels (where users can request resources)
  - Hold Ctrl/Cmd to select multiple
  - Examples: #orders, #marketplace

Step 4: Configure Admin Roles
------------------------------
‚Ä¢ Select roles that can manage bot configuration
‚Ä¢ Hold Ctrl/Cmd to select multiple roles
‚Ä¢ Examples: @Admin, @Moderator, @Officers

Step 5: Set Point Bonuses
--------------------------
‚Ä¢ Discord Order Fulfillment Bonus: 0-200% (recommended: 50%)
‚Ä¢ Website Addition Bonus: 0-200% (recommended: 0-100%)
‚Ä¢ Balance between Discord and website engagement

Step 6: Enable Features
------------------------
‚Ä¢ Toggle Auto-update embeds (recommended: ON)
‚Ä¢ Toggle Website notifications (recommended: ON for active guilds)
‚Ä¢ Toggle Public orders (ON for community-driven, OFF for admin-controlled)

Step 7: Save Configuration
---------------------------
‚Ä¢ Click "Save Configuration" button
‚Ä¢ Settings are stored per Discord server
‚Ä¢ Each server can have completely different settings

Step 8: Verify Bot Functionality
---------------------------------
‚Ä¢ Check bot appears online in your Discord server
‚Ä¢ Test bot commands in configured channels
‚Ä¢ Verify notifications appear when resources change
‚Ä¢ Check points are awarded correctly

====================================================================
MULTI-SERVER & MULTI-GUILD ARCHITECTURE
====================================================================

Understanding the Many-to-One Relationship:
-------------------------------------------
‚Ä¢ ONE Discord server can manage MULTIPLE in-game guilds ‚úÖ
‚Ä¢ ONE in-game guild can only belong to ONE Discord server ‚úÖ
‚Ä¢ Guilds on the same Discord server are completely separate from each other
‚Ä¢ Each guild has independent resources, leaderboards, and activity logs
‚Ä¢ Once a guild is linked to a Discord server, other servers cannot claim it

How It Works:
-------------
1. Multiple Guilds per Discord Server:
   ‚Ä¢ Your Discord can track "House Melange", "Whitelist Second Guild", etc.
   ‚Ä¢ Each guild is managed independently through the guild selector dropdown
   ‚Ä¢ Perfect for alliances managing multiple Houses/Clans from one Discord

2. Guild Exclusivity:
   ‚Ä¢ Once you link a guild to your Discord server, it's locked to that server
   ‚Ä¢ Other Discord servers cannot add or configure that guild
   ‚Ä¢ This prevents conflicts and ensures clear ownership

3. Independent Tracking:
   ‚Ä¢ Resources: Each guild has separate resource quantities
   ‚Ä¢ Leaderboards: Points tracked separately per guild
   ‚Ä¢ Activity Logs: Actions recorded per guild
   ‚Ä¢ Bot Configuration: Settings apply to selected guild only

4. Easy Guild Switching:
   ‚Ä¢ Use the guild selector dropdown on Resources page
   ‚Ä¢ Previous guild selection remembered via browser
   ‚Ä¢ Switch anytime to view/edit different guild's data
   ‚Ä¢ No data mixing between guilds

Why This Structure?
-------------------
‚Ä¢ Organized Management: Alliance leaders can manage multiple guilds from one Discord
‚Ä¢ Clear Ownership: Each guild belongs to one community only
‚Ä¢ Data Integrity: No confusion about which server controls which guild
‚Ä¢ Permission Clarity: Discord roles and permissions apply across all your guilds
‚Ä¢ Scalability: Add unlimited guilds to your Discord server as needed

Example Scenarios:
------------------
‚Ä¢ Single Guild Setup:
  - One Discord server managing one in-game guild
  - Simplest configuration
  - Most common for individual guilds/clans

‚Ä¢ Alliance Management:
  - One Discord server tracking 3 different Houses
  - Each House has separate resources and leaderboards
  - Alliance leaders can switch between Houses easily
  - Example: "Phoenix Alliance" Discord manages House Atreides, 
    House Harkonnen, and House Corrino

‚Ä¢ Multi-Faction Community:
  - Gaming community with separate Clans/Factions
  - All managed from one Discord server
  - Each faction competes independently on their own leaderboard
  - Resources don't mix between factions

What You CANNOT Do:
-------------------
‚úó Link the same guild to multiple Discord servers (guild exclusivity)
‚úó Share resources between guilds on your Discord (completely separate)
‚úó Combine leaderboards across guilds (tracked independently)
‚úó Transfer a guild to another Discord server (requires admin unlinking)

Important Notes:
----------------
‚Ä¢ Admin roles are server-specific, apply to all guilds on your server
‚Ä¢ Bot presence must be confirmed before configuration appears
‚Ä¢ Configuration changes only affect the selected Discord server
‚Ä¢ If your desired guild is already linked elsewhere, it cannot be added

====================================================================
TROUBLESHOOTING
====================================================================

‚è≥ Guild dropdown shows "No Guilds Available" or "Loading..."?
--------------------------------------------------------------
‚Ä¢ This is NORMAL during initial page load - the system is authenticating
  with Discord
‚Ä¢ The system automatically retries authentication after 1 second
‚Ä¢ Your guilds will appear automatically within 1-2 seconds
‚Ä¢ NO MANUAL REFRESH NEEDED - just wait for the automatic retry
‚Ä¢ If guilds don't appear after 5 seconds, try refreshing the page once
‚Ä¢ This behavior prevents race conditions between page load and Discord
  authentication
‚Ä¢ You may see this briefly when navigating between pages - this is expected

Technical Details:
‚Ä¢ The app waits for your Discord session to fully authenticate
‚Ä¢ It then fetches your Discord servers and matches them to configured guilds
‚Ä¢ If the first attempt is too early, it automatically retries
‚Ä¢ Your previous guild selection is remembered via browser localStorage

‚ùå Can't see my Discord server in the list?
-------------------------------------------
‚Ä¢ Ensure you've granted the app permission to see your servers when 
  logging in
‚Ä¢ Required OAuth scopes: identify, guilds, guilds.members.read
‚Ä¢ Try logging out and back in to refresh Discord token
‚Ä¢ Check Discord Developer Mode is enabled
‚Ä¢ Verify you have Administrator permissions or ownership on the server

‚ö†Ô∏è Server shows "Bot needs to be added to this server"?
-------------------------------------------------------
‚Ä¢ The bot isn't installed on that server yet
‚Ä¢ Only servers where the bot is installed can be configured
‚Ä¢ Click "Add Bot to Server" button to install
‚Ä¢ Grant Administrator permissions during installation
‚Ä¢ Refresh page after bot is added

üîÑ Changes not saving?
----------------------
‚Ä¢ Check browser console (F12) for detailed error messages
‚Ä¢ Ensure you've selected at least one in-game guild
‚Ä¢ Verify you have admin permissions on the Discord server
‚Ä¢ Check that at least one channel/role is selected (or leave empty)
‚Ä¢ Ensure bot is present in the server
‚Ä¢ Try refreshing the page and attempting again

üìä Bot not posting updates?
---------------------------
‚Ä¢ Ensure "Auto-Update Discord Embeds" is enabled in dashboard
‚Ä¢ Check that the bot has permissions to post in selected bot channels
‚Ä¢ Verify channel IDs are correct (no deleted channels selected)
‚Ä¢ Ensure bot has "Send Messages" and "Embed Links" permissions
‚Ä¢ Check bot is online in your Discord server
‚Ä¢ Review bot logs for connection errors

üîê Permission errors when configuring?
--------------------------------------
‚Ä¢ Verify you're an Administrator or Owner on the Discord server
‚Ä¢ Check that your Discord roles are properly synced
‚Ä¢ Try signing out and signing back in
‚Ä¢ Contact your server owner for role assignment

‚ö° Bot commands not working?
----------------------------
‚Ä¢ Ensure the bot is online and added to your Discord server
‚Ä¢ Verify bot has proper permissions in the configured channels
‚Ä¢ Check that you have the required roles to use specific commands
‚Ä¢ Try using commands in the channels you configured as order/bot channels
‚Ä¢ Contact support if commands continue to fail

====================================================================
AVAILABLE BOT COMMANDS
====================================================================

Core Commands (Available to all members):
------------------------------------------
/stock
‚Ä¢ Shows current resource levels for your guild
‚Ä¢ Displays quantities, categories, and status indicators
‚Ä¢ Color-coded by resource status (green=good, red=critical)

/leaderboard
‚Ä¢ Shows top contributors in your guild
‚Ä¢ Displays total points and recent activity
‚Ä¢ Updates in real-time as contributions are made

/help
‚Ä¢ Lists all available bot commands
‚Ä¢ Shows usage examples and descriptions
‚Ä¢ Provides quick reference for features

Order Management Commands:
--------------------------
Note: Available to all members if "Allow Public Orders" is enabled,
otherwise restricted to admin roles only.

/order create [item] [quantity]
‚Ä¢ Create a resource request
‚Ä¢ Example: /order create Metal Alloy 500
‚Ä¢ Bot notifies in configured order channels

/order list
‚Ä¢ View all pending orders
‚Ä¢ Shows requestor, item, quantity, and timestamp
‚Ä¢ Filter by your own orders or view all

/order fill [order_id]
‚Ä¢ Fulfill a pending order
‚Ä¢ Automatically awards bonus points based on configuration
‚Ä¢ Updates resource quantities and notifies requestor

/order cancel [order_id]
‚Ä¢ Cancel your own pending order
‚Ä¢ Admins can cancel any order
‚Ä¢ Removes from pending list

Admin Commands (Restricted to configured admin roles):
-------------------------------------------------------
/config show
‚Ä¢ Display current bot configuration for your server
‚Ä¢ Shows channels, roles, bonuses, and toggle settings
‚Ä¢ Useful for verifying setup

/stock update [item] [quantity] [reason]
‚Ä¢ Manually update resource quantities via Discord
‚Ä¢ Awards points based on website bonus percentage
‚Ä¢ Records action in audit log
‚Ä¢ Example: /stock update Iron Ore 1000 "Harvested from expedition"

/stock refresh
‚Ä¢ Force refresh the stock embed
‚Ä¢ Useful if auto-update is disabled
‚Ä¢ Manually syncs Discord with website data

====================================================================
NEED SUPPORT?
====================================================================

For additional help, feature requests, or bug reports:
‚Ä¢ Contact your server administrator for configuration assistance
‚Ä¢ Check the main dashboard for system announcements and updates
‚Ä¢ Review your bot configuration settings carefully in the dashboard
‚Ä¢ Report issues or request features through your community channels

Common Questions:
-----------------
Q: How do I add the bot to my Discord server?
A: Click the "Add Bot to Server" button in the Bot Dashboard after 
   selecting your server from the dropdown.

Q: Who can configure the bot settings?
A: Server owners and administrators can access the Bot Dashboard. 
   Admin roles configured in the dashboard can also modify settings.

Q: How are points calculated?
A: Base points are 0.1 per resource. ADD actions receive the configured
   website or Discord bonus (0-200%). SET actions award flat 1 point.
   Status bonuses add +10% for critical, +5% for below target.

Q: Can multiple Discord servers share the same in-game guild?
A: No. Each in-game guild belongs to exactly ONE Discord server. However,
   one Discord server can manage multiple in-game guilds (e.g., House A,
   House B, House C), with separate resources and leaderboards for each.

Q: What happens if I change the bonus percentages?
A: New bonuses apply to all future actions. Previously awarded points
   are not retroactively changed.

Q: How do I reset or clear old orders?
A: Use /order cancel for individual orders, or contact support for
   bulk order management.

====================================================================
SERVICE INFORMATION
====================================================================

This Resource Tracker system is hosted and maintained for your use.
All technical infrastructure, database management, and bot hosting
are handled centrally.

Data Privacy & Security:
------------------------
‚Ä¢ Your Discord data is used only for authentication and permissions
‚Ä¢ Resource data is stored securely in encrypted databases
‚Ä¢ GDPR compliant: You can export or delete your data at any time
‚Ä¢ Activity logs maintain transparency of all actions
‚Ä¢ No data is shared with third parties

System Availability:
--------------------
‚Ä¢ Bot and website are hosted 24/7 for continuous access
‚Ä¢ Regular backups ensure data protection
‚Ä¢ Automatic updates deployed without service interruption
‚Ä¢ Monitored for performance and uptime

Your Responsibilities:
----------------------
‚Ä¢ Configure your Discord server settings properly
‚Ä¢ Ensure bot has required permissions in your server
‚Ä¢ Manage admin roles and channel assignments
‚Ä¢ Monitor resource tracking for your guild
‚Ä¢ Report any issues or concerns promptly

====================================================================
VERSION INFORMATION
====================================================================

Resource Tracker Version: 1.0
Documentation Version: 3.0
Last Updated: November 2025

System Features:
----------------
‚Ä¢ Discord OAuth authentication
‚Ä¢ Multi-server support with independent configurations
‚Ä¢ Multi-guild resource tracking
‚Ä¢ Points system with configurable bonuses (0-200%)
‚Ä¢ Real-time leaderboards
‚Ä¢ Order management system
‚Ä¢ Complete activity audit logs
‚Ä¢ Auto-updating Discord embeds
‚Ä¢ Website and Discord integration
‚Ä¢ Mobile-responsive design with dark mode

====================================================================
END OF DOCUMENTATION
====================================================================

This guide covers everything you need to configure and use the
Discord Bot Dashboard and Resource Tracker system.

For ongoing support and feature requests, contact your community
administrators or use the designated support channels.

Thank you for using Resource Tracker!
====================================================================
